const t={validClass:"is-valid",invalidClass:"is-invalid",indicator:!0,indicatorElement:"span",indicatorPosition:"after",indicatorClass:"invalid-feedback",invalidForm:"Form is not valid!",invalidFormAlert:!1};class e{constructor(e){if(!e||"HTMLFormElement"!==e.constructor.name)throw new Error("Validator needs a form element");if(this.form=e,!this.form.hasAttribute("novalidate")){if(this.passiveSupported=(()=>{let t=!1;try{const e={get passive(){return t=!0,!0}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){return t=!1,!1}return t})(),this.elementsForValidation=[],this.validateFormElement=this.validateFormElement.bind(this),this.attachElement=this.attachElement.bind(this),this.debounced=function(t,e){let i;return function(...s){i&&clearTimeout(i),i=setTimeout(()=>{e(...s),i=null},t)}}(2e3,this.validateFormElement),this.options=t,this.form.dataset)for(const t in this.form.dataset)Object.prototype.hasOwnProperty.call(this.options,t)&&(this.options[t]="indicator"===t||"invalidFormAlert"===t?"true"===this.form.dataset[t]:this.form.dataset[t]);[].slice.call(this.form.elements).forEach(t=>{t.hasAttribute("disabled")||"FIELDSET"===t.tagName||(this.elementsForValidation.push(t),t.addEventListener("blur",this.validateFormElement,!this.passiveSupported||{passive:!0}),t.addEventListener("change",this.validateFormElement,!this.passiveSupported||{passive:!0}),t.addEventListener("input",this.debounced,!this.passiveSupported||{passive:!0}),this.options.indicator&&this.elementInit&&"function"==typeof this.elementInit&&this.elementInit(t))})}}validateFormElement(t){let e=null;if(!t||!t.target||t.target.form!==this.form)throw new Error("The element needs to be a children of a form element");e=t.target,e.checkValidity(),this.notify&&"function"==typeof this.notify&&this.notify(e,e.validity.valid)}getCustomMessage(t,e,i){if(!t||!e||!i)return null;const s=t.dataset;if("object"==typeof s){if(i.typeMismatch&&s[e+"Mismatch"])return s[e+"Mismatch"];for(const t in s)if(Object.prototype.hasOwnProperty.call(s,t)&&!0===i[t])return s[t]}return null}attachElement(t){!t.hasAttribute("disabled")&&t.willValidate&&(t.removeEventListener("blur",this.validateFormElement,!this.passiveSupported||{passive:!0}),t.removeEventListener("change",this.validateFormElement,!this.passiveSupported||{passive:!0}),t.removeEventListener("input",this.debounced,!this.passiveSupported||{passive:!0}),t.addEventListener("blur",this.validateFormElement,!this.passiveSupported||{passive:!0}),t.addEventListener("change",this.validateFormElement,!this.passiveSupported||{passive:!0}),t.addEventListener("input",this.debounced,!this.passiveSupported||{passive:!0}),this.options.indicator&&this.elementInit&&"function"==typeof this.elementInit&&this.elementInit(t))}}export{e as Formally};
