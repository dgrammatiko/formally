var FormValidator=function(t){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=function(){var t=!1;try{var i={get passive(){return t=!0,!0}};window.addEventListener("test",null,i),window.removeEventListener("test",null,i)}catch(i){return t=!1,!1}return t},o=function(t,i){var e;return function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];e&&clearTimeout(e),e=setTimeout((function(){i.apply(void 0,o),e=null}),t)}},a={validClass:"is-valid",invalidClass:"is-invalid",indicator:!0,indicatorElement:"span",indicatorPosition:"after",indicatorClass:"invalid-feedback",invalidForm:"Form is not valid!",invalidFormAlert:!1},r=function(){function t(i){if(function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.form=i,!i||"HTMLFormElement"!==i.constructor.name)throw new Error("Validator needs a form element");this.form.hasAttribute("novalidate")||(this.options=a,this.form.Formally=this,this.passiveSupported=n(),this.elementsForValidation=[],this.validateFormElement=this.validateFormElement.bind(this),this.attachElement=this.attachElement.bind(this),this.elementInit=this.elementInit.bind(this),this.notify=this.notify.bind(this),this.invalidFormNotification=this.invalidFormNotification.bind(this),this.debounced=o(99,this.validateFormElement),this.init())}var r,s,l;return r=t,(s=[{key:"invalidFormNotification",value:function(){}},{key:"notify",value:function(){}},{key:"elementInit",value:function(){}},{key:"validateFormElement",value:function(t){var i=null;if(!(i=t&&t.target?t.target:t))throw new Error("Method formElementValidate needs a valid event.target or a form element");Object.prototype.hasOwnProperty.call(i,"FormallyCustomValidator")&&"function"==typeof i.FormallyCustomValidator?(i.FormallyCustomValidator(),this.notify&&"function"==typeof this.notify&&this.notify(i,i.validity.valid)):(i.checkValidity(),this.notify&&"function"==typeof this.notify&&this.notify(i,i.validity.valid))}},{key:"getCustomMessage",value:function(t,e,n){if(!t||!e||!n)return null;var o=t.dataset;if("object"===i(o)){if(n.typeMismatch&&o["".concat(e,"Mismatch")])return o["".concat(e,"Mismatch")];for(var a in o)if(Object.prototype.hasOwnProperty.call(o,a)&&!0===n[a])return o[a]}return null}},{key:"isValid",value:function(){var t=this,i="i";return this.elementsForValidation.forEach((function(e){var n=e.checkValidity();t.notify&&"function"==typeof t.notify&&t.notify(e,n),"string"==typeof i||n||(i=e)})),!!this.form.checkValidity()||(this.invalidFormNotification&&"function"==typeof this.invalidFormNotification&&this.invalidFormNotification(),"string"!=typeof i&&i.focus(),!1)}},{key:"init",value:function(){var t=this;if(this.form.dataset)for(var i in this.form.dataset)Object.prototype.hasOwnProperty.call(this.form.Formally.options,i)&&(this.form.Formally.options[i]="indicator"===i||"invalidFormAlert"===i?"true"===this.form.dataset[i]:this.form.dataset[i]);[].slice.call(this.form.elements).forEach((function(i){i.hasAttribute("disabled")||void 0!==i.dataset.allowValidation&&"true"===i.dataset.allowValidation||"FIELDSET"===i.tagName||(t.elementsForValidation.push(i),i.addEventListener("blur",t.debounced,!t.passiveSupported||{passive:!0}),i.addEventListener("change",t.debounced,!t.passiveSupported||{passive:!0}),i.addEventListener("input",t.debounced,!t.passiveSupported||{passive:!0}),t.options.indicator&&t.elementInit&&"function"==typeof t.elementInit&&t.elementInit(i))}))}},{key:"attachElement",value:function(t){t.hasAttribute("disabled")||void 0!==t.dataset.allowValidation&&"true"===t.dataset.allowValidation||!t.willValidate||(t.removeEventListener("blur",this.debounced,!this.passiveSupported||{passive:!0}),t.removeEventListener("change",this.debounced,!this.passiveSupported||{passive:!0}),t.removeEventListener("input",this.debounced,!this.passiveSupported||{passive:!0}),t.addEventListener("blur",this.debounced,!this.passiveSupported||{passive:!0}),t.addEventListener("change",this.debounced,!this.passiveSupported||{passive:!0}),t.addEventListener("input",this.debounced,!this.passiveSupported||{passive:!0}),this.options.indicator&&this.elementInit&&"function"==typeof this.elementInit&&this.elementInit(t))}}])&&e(r.prototype,s),l&&e(r,l),t}();Object.defineProperty(r.prototype,"switchClasses",{writable:!0,configurable:!0,value:function(t,i){i?(t.classList.remove(this.options.invalidClass),t.classList.add(this.options.validClass)):(t.classList.remove(this.options.validClass),t.classList.add(this.options.invalidClass))}}),Object.defineProperty(r.prototype,"elementInit",{writable:!0,configurable:!0,value:function(t){if(!t.hasAttribute("disabled")){var i=t.closest("".concat(this.options.indicatorElement,"[aria-live]"));i||(i=document.createElement(this.options.indicatorElement)),i.setAttribute("aria-live","polite");var e,n=(e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)})()+e()+"-"+e()+e();i.id=n,t.setAttribute("aria-controls",n),i.classList.add(this.options.indicatorClass),"after"===this.options.indicatorPosition?(t.insertAdjacentElement("afterend",i),t.parentNode.appendChild(i)):"before"===this.options.indicatorPosition&&t.insertAdjacentElement("beforebegin",i)}}}),Object.defineProperty(r.prototype,"notify",{writable:!0,configurable:!0,value:function(t,i){var e=this;if(!t.hasAttribute("disabled")){var n=t.getAttribute("type"),o=i?null:this.getCustomMessage(t,t.type,t.validity);if(this.switchClasses(t,i),n&&"radio"===n)this.elementsForValidation.filter((function(i){return i.name!==t.name})).forEach((function(t){e.switchClasses(t,i)}));if(this.form.dataset&&0!==Object.keys(this.form.dataset).length&&"true"===this.form.dataset.indicator){if(o){t.setCustomValidity("");var a=t.parentNode.querySelector('[aria-live="polite"]');a&&(a.innerText=o)}}else document.activeElement===t&&t.reportValidity()}}}),Object.defineProperty(r.prototype,"invalidFormNotification",{writable:!0,configurable:!0,value:function(){}});var s=[].slice.call(document.querySelectorAll("form:not([novalidate]")),l=[].slice.call(document.querySelectorAll('[type="submit"]'));return s.forEach((function(t){new r(t)})),l.forEach((function(t){t.addEventListener("click",(function(i){t.form.Formally.isValid()||(i.preventDefault(),i.preventPropagation())}))})),t.Formally=r,t}({});
