var FormValidator=function(t){"use strict";const e="is-valid",i="is-invalid",s=!1,a=["badInput","patternMismatch","rangeOverflow","rangeUnderflow","stepMismatch","tooLong","tooShort","typeMismatch","valid","valueMissing"];return t.Formally=class{constructor(t){if(!t||"HTMLFormElement"!==t.constructor.name)throw new Error("Validator needs a form element");if(t.hasAttribute("novalidate"))return;this.form=t,this.elementsForValidation=[],this.validateFormElement=this.validateFormElement.bind(this),this.modifyElement=this.modifyElement.bind(this),this.debounced=function(t,e){let i;return function(){for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];i&&clearTimeout(i),i=setTimeout((()=>{e(...a),i=null}),t)}}(300,this.validateFormElement),this.switchClasses=this.switchClasses.bind(this),this.notify=this.notify.bind(this);const a=this.form.dataset;this.options={validClass:a.validClass?a.validClass:e,invalidClass:a.invalidClass?a.invalidClass:i,liveCheck:!(!a.liveCheck||"true"!==a.liveCheck)||s},Array.from(this.form.elements).forEach((t=>this.modifyElement(t,"add")));this.observer=new MutationObserver(((t,e)=>{t.forEach((t=>{t.addedNodes.length>0&&Array.from(this.form.elements).filter((t=>!this.elementsForValidation.includes(t))).forEach((t=>this.modifyElement(t,"add"))),t.removedNodes.length>0&&this.elementsForValidation.filter((t=>!Array.from(this.form.elements).includes(t))).forEach((t=>this.modifyElement(t,"remove")))}))})),this.observer.observe(this.form,{attributes:!1,childList:!0,subtree:!0})}validateFormElement(t){if(!t||!t.target||t.target.form!==this.form)throw new Error("The element needs to be a children of a form element");t.target.setCustomValidity(""),t.target.checkValidity(),this.notify(t.target,t.target.validity.valid)}getCustomMessage(t,e){let i="";if(!t||!e)return i;const s=t.dataset;return s?(a.forEach((e=>{!0===t.validity[e]&&s[e]&&(i=s[e])})),i):i}modifyElement(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add";!t.hasAttribute("disabled")&&t.willValidate&&"FIELDSET"!==t.tagName&&"OUTPUT"!==t.tagName&&(this.elementsForValidation.push(t),t[`${e}EventListener`]("blur",this.validateFormElement,{passive:!0}),t[`${e}EventListener`]("change",this.validateFormElement,{passive:!0}),this.options.liveCheck&&t[`${e}EventListener`]("input",this.debounced,{passive:!0}))}dispose(){Array.from(this.form.elements).forEach((t=>this.modifyElement(t,"remove"))),this.observer.disconnect(),this.observer=null}switchClasses(t,e){e?(t.classList.remove(this.options.invalidClass),t.classList.add(this.options.validClass)):(t.classList.remove(this.options.validClass),t.classList.add(this.options.invalidClass))}notify(t,e){if(t.hasAttribute("disabled"))return;const i=t.getAttribute("type");t.setCustomValidity(this.getCustomMessage(t,t.type)),this.switchClasses(t,e),i&&"radio"===i&&this.elementsForValidation.filter((e=>e.name!==t.name)).forEach((t=>this.switchClasses(t,e))),t.reportValidity()}isValid(){let t;return this.elementsForValidation.forEach((e=>{e.setCustomValidity("");const i=e.checkValidity();this.notify(e,i),t||i||(t=e)})),!!this.form.checkValidity()||(t&&t.focus(),!1)}},t}({});
