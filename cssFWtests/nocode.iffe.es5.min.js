var FormValidator=function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var a={instanceName:"Formally",customValidatorName:"FormallyCustomValidator",validClass:"is-valid",invalidClass:"is-invalid",indicator:!0,indicatorElement:"div",indicatorPosition:"after",indicatorClass:"invalid-feedback",attachChange:!1,attachInput:!1},s=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.form=e,!e||"HTMLFormElement"!==e.constructor.name)throw new Error("Validator needs a form element");if(!this.form.hasAttribute("novalidate")){if(this.options=a,this.form.dataset)for(var i in this.form.dataset)this.options.hasOwnProperty(i)&&(this.options[i]="indicator"===i||"attachChange"===i||"attachInput"===i?"true"===this.form.dataset[i]:this.form.dataset[i]);this.passiveSupported=!1,this.elementsForValidation=[],this.formElementValidate=this.formElementValidate.bind(this),this.reAttachElement=this.reAttachElement.bind(this),this.uaSupportsPassive(),this.init(),this.form[this.options.instanceName]=this}}var s,n,o;return s=t,(n=[{key:"uaSupportsPassive",value:function(){try{var t={get passive(){return this.passiveSupported=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){this.passiveSupported=!1}}},{key:"formElementValidate",value:function(t){var e=t.target;"function"==typeof e[this.options.customValidatorName]?e.customValidator():(e.checkValidity(),this.changeHtmlMarkup(e))}},{key:"getCustomMessage",value:function(t,i,a){var s=t.dataset;if("object"===e(s)){if(a.typeMismatch&&s[i+"Mismatch"])return s[i+"Mismatch"];for(var n in s)if(s.hasOwnProperty(n)&&a[n])return s[n]}}},{key:"switchClasses",value:function(t,e){e?(t.classList.remove(this.options.invalidClass),t.classList.add(this.options.validClass)):(t.classList.remove(this.options.validClass),t.classList.add(this.options.invalidClass))}},{key:"changeHtmlMarkup",value:function(t){var e=this,i=t.validity.valid,a=t.getAttribute("type"),s=i?null:this.getCustomMessage(t,t.type,t.validity);if(this.switchClasses(t,i),a&&"radio"===a){var n=t.name;this.elementsForValidation.forEach((function(a){(a.name&&a.name===n||a===t)&&e.switchClasses(a,i)}))}if(this.options.indicator){if(s){t.setCustomValidity("");var o=t.parentNode.querySelector('[aria-live="polite"]');o&&(o.innerText=s)}}else s&&t.setCustomValidity(s),t.reportValidity()}},{key:"isValid",value:function(){var t=this;return this.elementsForValidation.forEach((function(e){e.validity.valid?(e.classList.remove(t.options.validClass),e.classList.add(t.options.validClass)):(e.classList.add(t.options.validClass),e.classList.remove(t.options.validClass)),t.changeHtmlMarkup(e)})),!!this.form.checkValidity()}},{key:"init",value:function(){var t=this;[].slice.call(this.form.elements).forEach((function(e){var i,a=e.tagName.toLowerCase();if(a&&("input"===a||"select"===a||"textarea"===a)&&(t.elementsForValidation.push(e),e.addEventListener("blur",t.formElementValidate),t.passiveSupported,(t.options.attachChange||t.form.dataset.attachChange)&&e.addEventListener("change",t.formElementValidate,!!t.passiveSupported&&{passive:!0}),(t.options.attachInput||t.form.dataset.attachInput)&&e.addEventListener("change",t.formElementValidate,!!t.passiveSupported&&{passive:!0}),t.options.indicator&&t.form.dataset&&0!==Object.keys(t.form.dataset).length)){var s=document.createElement(t.options.indicatorElement);if(s){s.setAttribute("aria-live","polite");var n=(i=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)})()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i();s.id=n,e.setAttribute("aria-controls",n),s.classList.add(t.options.indicatorClass),"after"===t.options.indicatorPosition?(e.insertAdjacentElement("afterend",s),e.parentNode.appendChild(s)):"before"===t.options.indicatorPosition&&e.insertAdjacentElement("beforebegin",s)}}}))}},{key:"reAttachElement",value:function(t){t.removeEventListener("blur",this.formElementValidate,!!this.passiveSupported&&{passive:!0}),t.removeEventListener("change",this.formElementValidate,!!this.passiveSupported&&{passive:!0}),t.removeEventListener("input",this.formElementValidate,!!this.passiveSupported&&{passive:!0}),t.hasAttribute("required")&&(t.addEventListener("blur",this.formElementValidate,!!this.passiveSupported&&{passive:!0}),(this.options.attachChange||this.form.dataset.attachChange)&&t.addEventListener("change",this.formElementValidate,!!this.passiveSupported&&{passive:!0}),(this.options.attachInput||this.form.dataset.attachInput)&&t.addEventListener("input",this.formElementValidate,!!this.passiveSupported&&{passive:!0}))}}])&&i(s.prototype,n),o&&i(s,o),t}(),n=Array.from(document.querySelectorAll("form:not([novalidate]")),o=function(){n.forEach((function(t){new s(t)}))};return o(),t.def=o,t}({});
